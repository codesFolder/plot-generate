<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Insight - Analysis Workspace</title>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=JetBrains+Mono:wght@400;500&amp;display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
        rel="stylesheet" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#136dec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101822",
                        "surface-dark": "#181b21",
                        "border-dark": "#2d3748",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"],
                        "mono": ["JetBrains Mono", "monospace"],
                    },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                    boxShadow: {
                        "glow": "0 0 20px rgba(19, 109, 236, 0.3)",
                        "modal": "0 25px 50px -12px rgba(0, 0, 0, 0.5)"
                    }
                },
            },
        }
    </script>
    <style>
        /* Custom scrollbar for data-heavy views */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #111418;
        }

        ::-webkit-scrollbar-thumb {
            background: #2d3748;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #4a5568;
        }

        .glass-panel {
            background: rgba(16, 24, 34, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }

        /* Modal Glass */
        .modal-glass {
            background: rgba(28, 37, 48, 0.75);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .chart-grid {
            background-image: linear-gradient(to right, #2d3748 1px, transparent 1px),
                linear-gradient(to bottom, #2d3748 1px, transparent 1px);
            background-size: 40px 40px;
            mask-image: linear-gradient(to bottom, rgba(0, 0, 0, 1) 40%, rgba(0, 0, 0, 0));
            opacity: 0.1;
        }

        /* Hide utilities */
        .hidden {
            display: none !important;
        }
    </style>

    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <!-- SheetJS for Excel Support -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body
    class="bg-background-light dark:bg-background-dark text-[#111418] dark:text-white font-display overflow-hidden h-screen flex flex-col selection:bg-primary selection:text-white">

    <!-- Top Navbar -->
    <header
        class="flex items-center justify-between whitespace-nowrap border-b border-solid border-border-dark px-6 py-3 bg-[#111418] z-30 shrink-0">
        <div class="flex items-center gap-4 text-white">
            <div class="size-8 text-primary">
                <svg class="w-full h-full" fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M24 45.8096C19.6865 45.8096 15.4698 44.5305 11.8832 42.134C8.29667 39.7376 5.50128 36.3314 3.85056 32.3462C2.19985 28.361 1.76794 23.9758 2.60947 19.7452C3.451 15.5145 5.52816 11.6284 8.57829 8.5783C11.6284 5.52817 15.5145 3.45101 19.7452 2.60948C23.9758 1.76795 28.361 2.19986 32.3462 3.85057C36.3314 5.50129 39.7376 8.29668 42.134 11.8833C44.5305 15.4698 45.8096 19.6865 45.8096 24L24 24L24 45.8096Z"
                        fill="currentColor"></path>
                </svg>
            </div>
            <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">Insight</h2>
        </div>
        <div class="flex flex-1 justify-end gap-6 items-center">
            <!-- Search -->
            <div class="relative hidden md:block">
                <span
                    class="material-symbols-outlined absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-[20px]">search</span>
                <input
                    class="h-9 w-64 rounded-lg bg-[#282f39] border-none text-sm text-white pl-10 pr-4 focus:ring-1 focus:ring-primary placeholder-gray-500"
                    placeholder="Search data..." type="text" />
            </div>
            <div class="flex gap-2">
                <button id="view-report-btn"
                    class="flex items-center gap-2 h-9 px-3 rounded-lg bg-[#282f39] hover:bg-[#323b47] text-white text-sm font-medium border border-transparent hover:border-gray-600 transition-all shadow-sm">
                    <span class="material-symbols-outlined text-[18px]">assignment</span>
                    <span>Report Builder</span>
                </button>
                <button id="export-btn"
                    class="flex items-center gap-2 h-9 px-3 rounded-lg bg-[#282f39] hover:bg-[#323b47] text-white text-sm font-medium border border-transparent hover:border-gray-600 transition-all shadow-sm">
                    <span class="material-symbols-outlined text-[18px]">image</span>
                    <span>Save Image</span>
                </button>
            </div>
            <div class="bg-center bg-no-repeat bg-cover rounded-full size-9 border border-[#282f39]"
                style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuAw7TjsiXi4vY-BZ-A3bQgC_HIvCTKKANWzGUNZgwFTyac2HUcV9Vpl6e_Qarho5lUUnJZJaWrmLerrTycYg3Al4-qk5fdcvHLi6LM6iePHYfe9UAb2cFX926EV7hZDIGV1BeJMGMKeQDavuB4yrCAznUutoMo7FfNQYYF_DcJ1sXVwvM2JzgRNzI5ZQ-GX6XCq02p_xRjWsJj0rEfue37qLd-JQUMB_Kcsdq2fyYnombrRyWsDxLWss_TzAYTLRSPL6zTXE20gpPg");'>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="flex flex-1 overflow-hidden relative">

        <!-- Left Sidebar (Control Panel) -->
        <aside
            class="w-64 bg-[#111418] border-r border-border-dark flex flex-col shrink-0 overflow-y-auto hidden md:flex">
            <!-- Sidebar Content for Navigation / Triggers -->
            <div class="p-4">
                <button id="btn-new-project"
                    class="w-full flex items-center justify-center gap-2 rounded-lg py-2.5 bg-primary hover:bg-blue-600 text-white font-semibold transition-all shadow-glow">
                    <span class="material-symbols-outlined text-[20px]">add</span>
                    New Project
                </button>
            </div>

            <!-- Navigation -->
            <nav class="flex flex-col gap-1 px-2">
                <div
                    class="flex items-center gap-3 px-3 py-2.5 rounded-lg bg-[#1c2530] border border-[#282f39] text-white cursor-default">
                    <span class="material-symbols-outlined text-[20px] text-primary">analytics</span>
                    <p class="text-sm font-medium">Workspace</p>
                </div>
            </nav>

            <!-- PLACEHOLDER FOR DYNAMIC CONTROLS -->
            <div id="dynamic-controls" class="flex-1 px-2 py-4 space-y-4">
                <!-- Controls will be injected here by UI.js -->
                <p class="text-xs text-gray-500 text-center uppercase tracking-wider">Load data to view controls</p>
            </div>

            <!-- Sidebar Footer -->
            <div class="p-4 border-t border-border-dark">
                <div class="flex items-center gap-2 text-xs text-gray-500">
                    <span class="material-symbols-outlined text-[16px]">info</span>
                    <span>Insight v2.0 (Redesign)</span>
                </div>
            </div>
        </aside>

        <!-- Main Workspace Stage -->
        <main id="content" class="flex-1 flex flex-col relative bg-[#0f1115] w-full min-w-0">
            <!-- DASHBOARD CONTROLS (Injected via ui.js) -->
            <div id="dashboard-controls-bar" class="hidden border-b border-border-dark bg-[#111418] p-4 z-20"></div>

            <!-- EMPTY STATE -->
            <div id="empty-state" class="h-full flex flex-col items-center justify-center p-8 text-center opacity-50">
                <span class="material-symbols-outlined text-[64px] text-gray-600 mb-4">query_stats</span>
                <h3 class="text-xl font-bold text-gray-400">Ready to Analyze</h3>
                <p class="text-gray-500 max-w-sm mt-2 mb-8">Create a new project or upload a dataset to begin exploring
                    your data.</p>

                <button id="btn-create-project-center"
                    class="flex items-center gap-3 px-6 py-3 rounded-xl bg-primary hover:bg-blue-600 text-white font-bold text-lg shadow-glow hover:scale-105 transition-all">
                    <span class="material-symbols-outlined text-[24px]">add_circle</span>
                    Create New Project
                </button>
            </div>
        </main>
    </div>

    <!-- MAGIC UPLOAD MODAL OVERLAY -->
    <!-- ID: modal -->
    <div id="modal" aria-modal="true" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6"
        role="dialog">
        <!-- Backdrop -->
        <div id="close-modal-backdrop"
            class="absolute inset-0 bg-background-dark/60 backdrop-blur-sm transition-opacity cursor-pointer"></div>
        <!-- Modal Container -->
        <div
            class="relative w-full max-w-2xl transform overflow-hidden rounded-2xl modal-glass shadow-modal transition-all flex flex-col">
            <!-- Modal Header -->
            <div class="flex items-center justify-between border-b border-[#ffffff10] px-6 py-4">
                <div class="flex items-center gap-3">
                    <div
                        class="flex items-center justify-center size-8 rounded-lg bg-primary/20 text-primary ring-1 ring-primary/30">
                        <span class="material-symbols-outlined text-[20px]">cloud_upload</span>
                    </div>
                    <div>
                        <h3 class="text-white text-lg font-bold leading-none">Import New Dataset</h3>
                        <p class="text-[#9da8b9] text-xs mt-1">Add data sources to your Insight workspace</p>
                    </div>
                </div>
                <button id="close-modal"
                    class="text-[#9da8b9] hover:text-white transition-colors rounded-lg p-1 hover:bg-[#ffffff10]">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>
            <!-- Modal Body -->
            <div class="p-6 sm:p-8 flex flex-col gap-6">
                <!-- Drop Zone -->
                <div class="relative group cursor-pointer">
                    <div
                        class="absolute -inset-0.5 bg-gradient-to-r from-primary to-blue-600 rounded-xl blur opacity-20 group-hover:opacity-40 transition duration-500">
                    </div>
                    <label
                        class="relative flex flex-col items-center justify-center w-full h-64 border-2 border-dashed border-primary bg-[#136dec]/5 rounded-xl transition-all duration-300 group-hover:bg-[#136dec]/10 cursor-pointer">
                        <input type="file" id="file-input" accept=".csv, .xlsx, .xls" class="hidden" />
                        <div class="mb-4 relative">
                            <div class="absolute inset-0 bg-primary/40 blur-xl rounded-full"></div>
                            <span
                                class="relative material-symbols-outlined text-primary text-[64px] drop-shadow-lg">cloud_upload</span>
                        </div>
                        <h4 class="mb-2 text-xl font-semibold text-white tracking-tight">Drop files to upload</h4>
                        <p class="mb-6 text-sm text-[#9da8b9] max-w-xs text-center leading-relaxed">
                            Support for CSV, Excel (.xlsx, .xls). <br /> Max file size 50MB.
                        </p>
                        <span
                            class="bg-[#282f39] hover:bg-[#323b47] text-white text-sm font-semibold py-2.5 px-6 rounded-lg border border-[#ffffff10] shadow-sm transition-all flex items-center gap-2 group-hover:scale-105">
                            Browse
                        </span>
                    </label>
                </div>

                <!-- Paste Area -->
                <div class="flex flex-col gap-2">
                    <label class="text-xs font-semibold uppercase tracking-wider text-[#9da8b9]">Or Paste Data</label>
                    <textarea id="paste"
                        class="w-full h-24 bg-[#111418]/60 border border-[#ffffff10] rounded-lg p-3 text-sm text-gray-300 font-mono focus:ring-1 focus:ring-primary focus:border-primary placeholder-gray-600 resize-none"
                        placeholder="Date,Value,Category&#10;2024-01-01,100,A..."></textarea>
                </div>
            </div>
            <!-- Modal Footer -->
            <div class="bg-[#111418]/40 px-6 py-4 flex items-center justify-between border-t border-[#ffffff08]">
                <div class="flex items-center gap-2 text-[#9da8b9] text-xs">
                    <span class="material-symbols-outlined text-[16px]">lock</span>
                    <span>End-to-end encrypted</span>
                </div>
                <div class="flex gap-3">
                    <button
                        class="px-4 py-2 text-sm font-medium text-white bg-transparent border border-[#ffffff10] rounded-lg hover:bg-[#ffffff05] transition-colors">
                        Cancel
                    </button>
                    <button id="load"
                        class="px-6 py-2 text-sm font-bold text-white bg-primary rounded-lg shadow-lg hover:bg-blue-600 transition-colors flex items-center gap-2">
                        Load Dataset
                        <span class="material-symbols-outlined text-[18px]">arrow_forward</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Initialization Scripts -->
    <script type="module" src="js/main.js"></script>
    <!-- REPORT MODAL -->
    <div id="report-modal" aria-modal="true"
        class="hidden fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6" role="dialog">
        <div id="close-report-backdrop"
            class="absolute inset-0 bg-background-dark/80 backdrop-blur-sm transition-opacity cursor-pointer"></div>
        <div
            class="relative w-full max-w-3xl max-h-[90vh] flex flex-col transform overflow-hidden rounded-2xl modal-glass shadow-modal transition-all">
            <!-- Header -->
            <div class="flex items-center justify-between border-b border-[#ffffff10] px-6 py-4 bg-[#111418]">
                <h3 class="text-white text-lg font-bold">Report Builder</h3>
                <button id="close-report-modal" class="text-[#9da8b9] hover:text-white transition-colors">
                    <span class="material-symbols-outlined">close</span>
                </button>
            </div>

            <!-- Config Body -->
            <div class="flex-1 overflow-y-auto p-6 space-y-6">
                <!-- Title Config -->
                <div>
                    <label class="text-xs font-semibold uppercase tracking-wider text-[#9da8b9]">Report Title</label>
                    <input id="report-title" type="text"
                        class="mt-2 w-full bg-[#1c2530] border border-[#282f39] text-white rounded-lg p-3 text-sm focus:ring-primary focus:border-primary"
                        value="Data Analysis Report" placeholder="Enter report name...">
                </div>

                <!-- Global Options -->
                <div class="grid grid-cols-2 gap-4">
                    <label
                        class="flex items-center gap-3 p-3 rounded-lg border border-[#282f39] bg-[#1c2530] cursor-pointer hover:border-gray-500 transition-colors">
                        <input id="include-summary" type="checkbox"
                            class="rounded bg-[#111418] border-gray-600 text-primary focus:ring-primary appearance-none h-4 w-4"
                            checked>
                        <span class="text-sm font-medium text-white">Include Summary Stats</span>
                    </label>
                    <label
                        class="flex items-center gap-3 p-3 rounded-lg border border-[#282f39] bg-[#1c2530] cursor-pointer hover:border-gray-500 transition-colors">
                        <input id="include-heatmap" type="checkbox"
                            class="rounded bg-[#111418] border-gray-600 text-primary focus:ring-primary appearance-none h-4 w-4"
                            checked>
                        <span class="text-sm font-medium text-white">Include Correlation Heatmap</span>
                    </label>
                </div>

                <!-- Items List -->
                <div>
                    <div class="flex items-center justify-between mb-2">
                        <label class="text-xs font-semibold uppercase tracking-wider text-[#9da8b9]">Selected
                            Views</label>
                        <span id="report-count"
                            class="text-xs text-primary font-mono bg-primary/10 px-2 py-0.5 rounded">0 Items</span>
                    </div>
                    <div id="report-items-list" class="space-y-2 min-h-[100px]">
                        <!-- Items injected here -->
                        <div
                            class="text-center py-8 border-2 border-dashed border-[#282f39] rounded-lg text-gray-500 text-sm">
                            <span class="material-symbols-outlined block text-[24px] mb-2 opacity-50">add_chart</span>
                            No charts added. Click "Add View" on the dashboard.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="border-t border-[#ffffff10] px-6 py-4 bg-[#111418] flex justify-end gap-3">
                <button id="download-html-btn"
                    class="flex items-center gap-2 px-6 py-2 bg-primary hover:bg-blue-600 text-white font-bold rounded-lg shadow-glow transition-all">
                    <span class="material-symbols-outlined text-[18px]">html</span>
                    Download HTML Report
                </button>
            </div>
        </div>
    </div>

    <style>
        /* Custom Checkbox workaround for Tailwind Forms plugin if needed */
        input[type="checkbox"]:checked {
            background-color: #136dec;
            border-color: #136dec;
            background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
        }
    </style>

    <script>
        // Quick Modal Logic for Report
        const reportModal = document.getElementById('report-modal');
        document.getElementById('close-report-backdrop').addEventListener('click', () => reportModal.classList.add('hidden'));
        document.getElementById('close-report-modal').addEventListener('click', () => reportModal.classList.add('hidden'));
    </script>
    <!-- SHEET SELECTION MODAL -->
    <div id="sheet-modal" aria-modal="true"
        class="hidden fixed inset-0 z-[60] flex items-center justify-center p-4 sm:p-6" role="dialog">
        <div class="absolute inset-0 bg-background-dark/80 backdrop-blur-sm transition-opacity"></div>
        <div
            class="relative w-full max-w-md transform overflow-hidden rounded-2xl modal-glass shadow-modal transition-all flex flex-col p-6">
            <h3 class="text-white text-lg font-bold mb-2">Select a Sheet</h3>
            <p class="text-gray-400 text-sm mb-4">This Excel file contains multiple sheets. Choose one to analyze.</p>

            <div id="sheet-list" class="flex flex-col gap-2 max-h-[300px] overflow-y-auto mb-4">
                <!-- Buttons injected here -->
            </div>

            <button id="cancel-sheet-btn"
                class="w-full py-2.5 rounded-lg border border-[#ffffff10] text-gray-300 hover:text-white hover:bg-[#ffffff05] transition-colors text-sm font-medium">
                Cancel
            </button>
        </div>
    </div>
</body>

</html>